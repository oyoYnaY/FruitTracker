# FruitTracker — Real‑Time **Fruit** Recognition & Calorie Estimator  

[Demo](FruitTracker-Demo.gif)

---

## 1 · What the project does
**FruitTracker** is a MATLAB proof‑of‑concept that recognises six fruits—**apple, avocado, banana, cauliflower, corn🌽, potato🥔**—from a webcam feed (or a still image).  
All heavy lifting happens inside MATLAB scripts:

1. **Image pre‑processing** → centre‑crop & resize to 100 × 100 px grayscale.  
2. **Neural‑network inference** → 10 000‑input, 4‑hidden‑layer feed‑forward net.  
3. **GUI rendering** → live camera preview, ROI selector, “Detect” button, predicted class.

The demo video shows the full workflow in action.

---

## 2 · Dataset
| Source | Link | Notes |
| ------ | ---- | ----- |
| **Fruits‑360 (v2020)** | <https://www.kaggle.com/datasets/moltean/fruits> | ~90 k RGB images, 100 × 100 px on white background. Extracted six classes, converted to grayscale for faster training. |

File rgb2Gray.m converts raw RGB images to 100 × 100 grayscale JPGs under data/<class>/.

---

## 3 · Neural‑network architecture & training details

| Item | Value |
| ---- | ----- |
| **Input size** | 100 × 100 grayscale → **10 000 features** (1 D vector) |
| **Network type** | MATLAB patternnet (feed‑forward classification) |
| **Hidden layers** | 4 fully‑connected layers, 30 neurons each<br>net = patternnet([30 30 30 30]); |
| **Activation** | Hidden layers: **tansig** (default) · Output: **softmax** |
| **Training algorithm** | Levenberg‑Marquardt (trainlm) |
| **Data split** | 70 % training · 15 % validation · 15 % test (MATLAB default) |
| **Epochs / early stop** | Max 300; stops early on 6 × validation‑fail |
| **Final training accuracy** | **99.9 %** on training set |
| **Held‑out test accuracy** | **96.36 %** (357 images) |
| **Confusion matrix** | Generated by getAccuracy.m *(see demo)* |

trainNet.m handles data loading, network creation, training, and saves weights to models/net.mat.

---

## 4 · Code overview

| File / Folder             | Purpose |
| ------------------------- | ------- |
| rgb2Gray.m              | Converts RGB dataset images ➜ 100 × 100 grayscale JPGs. |
| getInputMatrix.m        | Flattens each grayscale image to 10 000‑D vector; builds input & target matrices. |
| trainNet.m              | Creates **patternnet(4)**, trains up to 300 epochs, saves weights ➜ models/net.mat. |
| FruitTracker.mlapp      | MATLAB App Designer GUI: live preview, ROI selector, “Detect” button, predicted fruit & calories. |
| getTestingData.m        | Loads held‑out test images and prepares them for inference. |
| getAccuracy.m           | Runs inference on the test set and prints confusion matrix & overall accuracy. |
| data/                   | Grayscale training & test images (generated by rgb2Gray.m). |
| models/net.mat          | Saved neural‑network weights (created by trainNet.m). |

> **Dependencies:** MATLAB R2022a + Image Processing Toolbox + Deep Learning Toolbox (no extra packages).

---
