# FruitTrackerÂ â€” Realâ€‘Time **Fruit** Recognition & Calorie Estimator  

[Demo](FruitTracker-Demo.gif)

---

## 1â€¯Â·â€¯What the project does
**FruitTracker** is a MATLAB proofâ€‘ofâ€‘concept that recognises six fruitsâ€”**apple, avocado, banana, cauliflower, cornğŸŒ½, potatoğŸ¥”**â€”from a webcam feed (or a still image).  
All heavy lifting happens inside MATLAB scripts:

1. **Image preâ€‘processing** â†’ centreâ€‘crop & resize to 100â€¯Ã—â€¯100â€¯px grayscale.  
2. **Neuralâ€‘network inference** â†’ 10â€¯000â€‘input, 4â€‘hiddenâ€‘layer feedâ€‘forward net.  
3. **GUI rendering** â†’ live camera preview, ROI selector, â€œDetectâ€ button, predicted class.

The demo video shows the full workflow in action.

---

## 2â€¯Â·â€¯Dataset
| Source | Link | Notes |
| ------ | ---- | ----- |
| **Fruitsâ€‘360Â (v2020)** | <https://www.kaggle.com/datasets/moltean/fruits> | ~90â€¯k RGB images, 100â€¯Ã—â€¯100â€¯px on white background. Extracted six classes, converted to grayscale for faster training. |

File rgb2Gray.m converts raw RGB images to 100â€¯Ã—â€¯100 grayscale JPGs under data/<class>/.

---

## 3â€¯Â·â€¯Neuralâ€‘network architecture & training details

| Item | Value |
| ---- | ----- |
| **Input size** | 100â€¯Ã—â€¯100 grayscale â†’ **10â€¯000 features** (1â€¯DÂ vector) |
| **Network type** | MATLABÂ patternnet (feedâ€‘forward classification) |
| **Hidden layers** | 4 fullyâ€‘connected layers, 30 neurons each<br>net = patternnet([30 30 30 30]); |
| **Activation** | Hiddenâ€¯layers: **tansig** (default) Â· Output: **softmax** |
| **Training algorithm** | Levenbergâ€‘Marquardt (trainlm) |
| **Data split** | 70â€¯% training Â· 15â€¯% validation Â· 15â€¯% test (MATLAB default) |
| **Epochs / early stop** | Maxâ€¯300; stops early on 6â€¯Ã—â€¯validationâ€‘fail |
| **Final training accuracy** | **99.9â€¯%** on training set |
| **Heldâ€‘out test accuracy** | **96.36â€¯%** (357 images) |
| **Confusion matrix** | Generated by getAccuracy.m *(see demo)* |

trainNet.m handles data loading, network creation, training, and saves weights to models/net.mat.

---

## 4â€¯Â·â€¯Code overview

| File / Folder             | Purpose |
| ------------------------- | ------- |
| rgb2Gray.m              | Converts RGB dataset images âœ 100â€¯Ã—â€¯100 grayscale JPGs. |
| getInputMatrix.m        | Flattens each grayscale image to 10â€¯000â€‘D vector; builds input & target matrices. |
| trainNet.m              | Creates **patternnet(4)**, trains up to 300â€¯epochs, saves weights âœ models/net.mat. |
| FruitTracker.mlapp      | MATLABâ€¯App Designer GUI: live preview, ROI selector, â€œDetectâ€ button, predicted fruit & calories. |
| getTestingData.m        | Loads heldâ€‘out test images and prepares them for inference. |
| getAccuracy.m           | Runs inference on the test set and prints confusion matrix & overall accuracy. |
| data/                   | Grayscale training & test images (generated by rgb2Gray.m). |
| models/net.mat          | Saved neuralâ€‘network weights (created byÂ trainNet.m). |

> **Dependencies:** MATLABÂ R2022aâ€¯+ Image Processing ToolboxÂ + Deep Learning Toolbox (no extra packages).

---
